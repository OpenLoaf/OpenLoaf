# 项目彻底删除交互与后端实现设计

## 背景
当前项目树支持“移除”项目，但仅从列表中移除，不会删除磁盘文件。需求新增“彻底删除”能力，并通过勾选与输入确认字符串降低误删风险。

## 目标
- 在“移除项目”对话框中增加二次确认流程：勾选 + 输入 `delete` 才允许彻底删除。
- 未勾选时保持原“移除”行为。
- 彻底删除时删除项目根目录的磁盘文件，并移除项目映射。

## 非目标
- 不提供回收站或恢复功能。
- 不引入跨项目批量删除。

## 交互流程
1. 右键项目 -> 移除，打开对话框。
2. 默认提示“仅从项目列表移除，不会删除磁盘内容”。
3. 勾选“彻底删除”后显示输入框；只有输入 `delete` 才能执行彻底删除。
4. 主按钮根据状态切换文案与逻辑：未勾选为“移除”，勾选+输入正确为“彻底删除”。
5. 关闭对话框时重置勾选与输入状态。

## 后端实现
新增 `project.destroy` mutation：
- 输入：`{ projectId: string }`
- 流程：解析项目根路径 -> `fs.rm(rootPath, { recursive: true, force: true })` -> 移除项目映射（复用 `project.remove` 逻辑）。
- 返回：`{ ok: true }`

## 数据流
UI 触发：
- 未勾选：`project.remove` -> 刷新项目列表。
- 勾选+输入：`project.destroy` -> 刷新项目列表。

## 错误处理
- 缺少 `projectId`：前端 toast 提示。
- 磁盘删除失败：提示失败原因，不更新列表。
- 项目映射不存在：后端抛出 `Project not found.`，前端提示。

## 测试与验证
- 手动：勾选与输入 gating 行为正确，误删路径不触发。
- 手动：成功删除后项目列表刷新、项目根目录消失。
- 回归：移除流程与文件删除流程不互相影响。
